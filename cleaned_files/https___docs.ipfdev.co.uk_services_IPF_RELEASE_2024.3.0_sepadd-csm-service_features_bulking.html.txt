=== URL: https://docs.ipfdev.co.uk/services/IPF_RELEASE_2024.3.0/sepadd-csm-service/features/bulking.html ===
Bulk File Creation
The Bulker is part of the core functionality of IPF. It provides a persistent store that processing flows are able to submit components to, over a given period of time. Using a pre-configured trigger, the Bulker will stop accepting new components and write all the components it has to a structured file.
Within the SEPA DD CSM, the Bulker is configured to accept Customer Direct Debit Transactions and write these to one of many pacs.003 messages (each for a given Direct/Indirect Participant and settlement date). Prior to the daily SEPA DD Core Collection Scheme Cutoff time (currently 11:00 CET), a trigger will be configured to close all the open pacs.003 messages, update their headers and add them to an IDF. Once the IDF is written to file, a notification will be sent to the configured destination to inform downstream systems that the IDF is ready for delivery to the EBA scheme. New Bulks will be opened automatically when the full Bulks close, so that there is no down-time or disruption to the service.
The Bulker is configured to hold Bulks and create batch files for all the outbound messages and files:
IDF - pacs.003
Multi Level Bulking
In order to group individual payments into the correct pacs.003 messages to pass scheme validation, the Bulker is configured to use multi-level bulking, auto-generated, re-occurring Bulks.
Each pacs.003 within the Bulker is a separate Bulk with all the functionality that comes with a Bulk (add components, remove components, query components etc). In order to use the Multi Level Bulking functionality, however, these bulks are not configured to stream to a File when finalised. A Multi-level bulk is linked as a "Child" to a "Parent Bulk" (ie the IDF file), this means that when the Parent is ready to be streamed to a File, the whole of the Child will be included as a single component within it. An IDF file will end up containing multiple pacs.003 that have all been built separately from common transactions.
The pacs.003 Bulks are configured to use the auto-generation functionality. It is not possible to pre-define every possible pacs.003 that could be needed and have a Bulk for them, ready in the Bulker waiting to be filled.  When a request is made to put a transaction into a pacs.003 bulk, if the appropriate bulk is not present it will be automatically generated using the defined parameters. Subsequent transactions to the given pacs.003 will be added as per any normal Bulk.
IDF files are needed for each LAC and can be predefined; as a re-occurring Bulk. This means each time an IDF Bulk is closed a new Bulk is automatically created to the same specification and ready to accept notifications as soon as a new Child pacs.003 is created.
The combination of auto-generation and re-occurring functionality gives seamless availability, thus ensuring no transactions are missed.
Correlation Store
File Debulking
